<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.6 $ -->
<!-- EN-Revision: 1.1 Maintainer: nobody Status: ready -->
 <reference xml:id="ref.oci8" xmlns="http://docbook.org/ns/docbook">
  <title>Oracle 8 Funktionen</title>
  <titleabbrev>OCI8</titleabbrev>
  <partintro>
   <para>
    Diese Funktionen gestatten den Zugriff auf Oracle7 und Oracle8 Datenbanken.
    Es wird hierbei das Oracle8 Call-Interface (OCI8) verwendet, welches
    installierte Oracle8 Client Bibliotheken (Libraries) benötigt.
   </para>
   <para>
    Diese Schnittstelle ist flexibler als die Standard Oracle Funktionen.
    Es unterstützt Binding von localen und globalen PHP Variablen an
    Oracle Platzhalter und hat volle LOB,FILE und ROWID Unterstützung und
    gestattet dem Benutzer die Verwendung von Variablendefines.
   </para>
   <para>
    Vor der Benutzung dieser Erweiterung sollten Sie sicherstellen die folgenden
    Umgebungsvariablen für den Webserveruser VOR dem Start des Webservers 
    gesetzt zu haben.
    <itemizedlist>
     <listitem>
      <simpara>
       ORACLE_HOME
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORACLE_SID
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_PRELOAD
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_LIBRARY_PATH
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       NLS_LANG
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORA_NLS33
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    Nachdem Sie die Umgebungsvariablen festgelegt haben, stellen Sie sicher, 
    das die Dateien im ORACLE_HOME/network/admin für den Webserver lesbar sind.
   </para>
   <note>
    <title>Wenn der Webserver abstürzt nach dem Start, oder nicht startet</title>
    <para>
     Überprüfen Sie, ob der Apache gegen -lpthread gelink ist:
    </para>
    <para>
     <informalexample>
      <programlisting>
# ldd /www/apache/bin/httpd 
    libpthread.so.0 => /lib/libpthread.so.0 (0x4001c000)
    libm.so.6 => /lib/libm.so.6 (0x4002f000)
    libcrypt.so.1 => /lib/libcrypt.so.1 (0x4004c000)
    libdl.so.2 => /lib/libdl.so.2 (0x4007a000)
    libc.so.6 => /lib/libc.so.6 (0x4007e000)
    /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
      </programlisting>
     </informalexample>
    </para>
    <para>
     Wenn libpthread hier nicht gelistet ist, dann muss der Webserver
     neu übersetzt werden:
    </para>
    <para>
     <informalexample>
      <programlisting>
# cd /usr/src/apache_1.3.xx
# make clean
# LIBS=-lpthread ./config.status
# make
# make install
      </programlisting>
     </informalexample>
    </para>
   </note>
   <para>
    <example>
     <title>OCI Hinweise</title>
      <programlisting role="php">
&lt;?php
// by sergo@bacup.ru

// Die Option OCI_DEFAULT führt die Anweisung in einer Transaktion aus 
OCIExecute($stmt, OCI_DEFAULT);

// for retrieve data use (after fetch):

$result = OCIResult($stmt, $n);
if (is_object ($result)) $result = $result-&gt;load();

// For INSERT or UPDATE statement use:

$sql = "insert into table (field1, field2) values (field1 = 'value',
 field2 = empty_clob()) returning field2 into :field2";
OCIParse($conn, $sql);
$clob = OCINewDescriptor($conn, OCI_D_LOB);
OCIBindByName ($stmt, ":field2", &amp;$clob, -1, OCI_B_CLOB);
OCIExecute($stmt, OCI_DEFAULT);
$clob-&gt;save ("some text");
OCICommit($conn);

?&gt;
     </programlisting>
    </example>
   </para>
   <para>
    Man kann auf Stored Procedures auf einfache Weise zugreifen.
    <example>
     <title>Stored Procedures benutzen</title>
      <programlisting role="php">
&lt;?php
// by webmaster@remoterealty.com
$sth = OCIParse ( $dbh, "begin sp_newaddress( :address_id, '$firstname',
 '$lastname', '$company', '$address1', '$address2', '$city', '$state',
 '$postalcode', '$country', :error_code );end;" );

// This calls stored procedure sp_newaddress, with :address_id being an
// in/out variable and :error_code being an out variable. 
// Then you do the binding:

   OCIBindByName ( $sth, ":address_id", $addr_id, 10 );
   OCIBindByName ( $sth, ":error_code", $errorcode, 10 );
   OCIExecute ( $sth );

?&gt;
     </programlisting>
    </example>
   </para>
  </partintro>	

&reference.oci8.functions;

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

