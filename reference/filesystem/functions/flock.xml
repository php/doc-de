<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.5 $ -->
<!-- EN-Revision: 1.5 Maintainer: tom Status: ready -->
  <refentry id="function.flock">
   <refnamediv>
    <refname>flock</refname>
    <refpurpose>Portables Datei-Verriegelungs-Verfahren</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Beschreibung</title>
     <methodsynopsis>
      <type>bool</type><methodname>flock</methodname>
      <methodparam><type>resource</type><parameter>handle</parameter></methodparam>
      <methodparam><type>int</type><parameter>operation</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>&amp;wouldblock</parameter></methodparam>
     </methodsynopsis>
    <simpara>
     PHP liefert einen portablen Weg, Dateien in einer "beratenden"
     Art und Weise zu verriegeln. D.h. alle zugreifende Programme
     müssen die gleiche Art und Weise der Verriegelung benutzen, oder
     es funktioniert nicht.
    </simpara>
    <simpara>
     <function>flock</function> arbeitet mit <parameter>handle</parameter>,
     welcher ein existierender Dateizeiger sein muss. Der Parameter
     <parameter>operation</parameter> bestimmt die Art der
     Verriegelung und kann einen der folgenden Werte annehmen:
    </simpara>
    <para>
     <itemizedlist>
      <listitem>
       <simpara>
        Um eine verteilte, nur lesende Verriegelung zu erhalten,
        setzten Sie <parameter>operation</parameter> auf LOCK_SH (bzw.
        1 vor PHP 4.0.1).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Um eine exklusive, nur schreibende Verriegelung zu erhalten,
        setzen Sie <parameter>operation</parameter> auf LOCK_EX (bzw.
        2 vor PHP 4.0.1).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Um eine Verriegelung freizugeben (lesend oder schreibend),
        setzten Sie <parameter>operation</parameter> auf LOCK_UN (bzw.
        3 vor PHP 4.0.1).
       </simpara>
      </listitem>
      <listitem>
       <simpara>
        Wenn Sie Zugriffe während der Verriegelung durch
        <function>flock</function> erlauben wollen, fügen Sie LOCK_NB 
        (bzw. 4 vor PHP 4.0.1) zu <parameter>operation</parameter> hinzu.
       </simpara>
      </listitem>
     </itemizedlist>
    </para>
    <simpara>
     <function>flock</function> erlaubt es Ihnen ein einfaches
     Leser/Schreiber Modell zu erstellen, welches auf fast jeder Plattform
     benutzt werden kann (inkl. den meisten UNIX-Derivaten und auch Windows).
     Das optionale dritte Argument ist auf &true; gesetzt, wenn die 
     Verriegelung sperren sollte (EWOULDBLOCK errno Bedingung).
    </simpara>
    <simpara>
     <function>flock</function> gibt &true; bei Erfolg, &false; wenn ein
     Fehler auftrat (z.B. wenn eine Verriegelung nicht erstellt werden
     konnte) zurück.
    </simpara>
    <note>
     <para>
      Da <function>flock</function> einen Dateizeiger benötigt, könnten Sie
      eine spezielle Sperrdatei benutzen, um den Zugriff auf eine Datei zu
      schützen, welche Sie mittels Öffnen im Schreibmodus (mit dem Argument
      "w" or "w+" von <function>fopen</function>) kürzen wollen.
     </para>
    </note>
    <warning>
     <para>
      <function>flock</function> funktioniert nicht auf NFS und verschiedenen
      anderen vernetzten Dateisystemen. Für weitere Detail konsultieren Sie
      bitte Ihre Betriebssystemdokumentation.
     </para>
     <para>
      Bei einigen Betriebssystemen ist <function>flock</function> auf dem
      Prozesslevel implementiert. Wenn Sie ein multithreaded Server API wie
      ISAPI benutzen können Sie sich nicht auf <function>flock</function>
      verlassen, um Dateien vor anderen PHP-Skripten zu schützen, welche in
      parallelen Threads der gleichen Server-Instanz laufen!
     </para>
     <para>
      <function>flock</function> wird antiquierten Dateisystemen wie 
      <literal>FAT</literal> und dessen Derivate nicht unterstützt, und gibt
      deshalb in solchen Umgebungen immer &false; zurück (Dies ist speziell
      bei Windows 98 Benutzern der Fall).
     </para>
    </warning>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
